CREATE SEQUENCE "DGMARCU2"."AS3_CLIENT_ID_SEQ" MINVALUE 1 MAXVALUE 999999999999 INCREMENT BY 1 START WITH 1;




CREATE TABLE "DGMARCU2"."AS3_WORK"
 (
   "WORK_NM" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   "COST_HOUR" FLOAT NOT NULL ENABLE,
   "IS_PACKAGE" VARCHAR2(1 BYTE) NOT NULL ENABLE,
   "DESCRIPTION" VARCHAR2(2000 BYTE),
   CONSTRAINT "AS3_WORK_PK" PRIMARY KEY ("WORK_NM") ENABLE,
   CONSTRAINT "AS3_IS_PACKAGE_CHK1" CHECK (IS_PACKAGE IN ('Y', 'N')) ENABLE
 );

 COMMENT ON COLUMN "DGMARCU2"."AS3_WORK"."IS_PACKAGE" IS 'FUNCTIONS AS BOOLEAN. ACCEPTABLE ANSWERS: Y N ';




CREATE TABLE "DGMARCU2"."AS3_CLIENT"
 (
   "CLIENT_ID" NUMBER NOT NULL ENABLE,
   "FNAME" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   "LNAME" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   "HOUSE_SIZE" NUMBER NOT NULL ENABLE,
   "NUM_BATHS" NUMBER NOT NULL ENABLE,
   "STREET_ADDRESS" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   "CITY" VARCHAR2(200 BYTE) NOT NULL ENABLE,
   "STATE" CHAR(2 BYTE) NOT NULL ENABLE,
   "ZIP" VARCHAR(10 BYTE) NOT NULL ENABLE,
   "WORK_PHONE" VARCHAR2(10 BYTE),
   "HOME_PHONE" VARCHAR2(10 BYTE),
   CONSTRAINT "AS3_CLIENT_PK" PRIMARY KEY ("CLIENT_ID") ENABLE,
   CONSTRAINT "AS3_CLIENT_WORK_PHONE_CHK1" CHECK (REGEXP_LIKE(WORK_PHONE, '[0-9]{3}-?[0-9]{3}-?[0-9]{4}')) ENABLE,
   CONSTRAINT "AS3_CLIENT_HOME_PHONE_CHK1" CHECK (REGEXP_LIKE(HOME_PHONE, '[0-9]{3}-?[0-9]{3}-?[0-9]{4}')) ENABLE
 );

 COMMENT ON COLUMN "DGMARCU2"."AS3_CLIENT"."HOUSE_SIZE" IS 'NOT NULLABLE SO THAT THE AMOUNT OF TIME CLEANING THE HOUSE WILL TAKE CAN BE ESTIMATED';
 COMMENT ON COLUMN "DGMARCU2"."AS3_CLIENT"."NUM_BATHS" IS 'NOT NULLABLE SO THAT THE AMOUNT OF TIME CLEANING THE HOUSE WILL TAKE CAN BE ESTIMATED';
 COMMENT ON COLUMN "DGMARCU2"."AS3_CLIENT"."STATE" IS 'ASSUMING ALL CLIENTS RESIDE WITHIN THE UNITED STATES';
 COMMENT ON COLUMN "DGMARCU2"."AS3_CLIENT"."ZIP" IS 'ASSUMING ALL CLIENTS RESIDE WITHIN THE UNITED STATES';
 COMMENT ON COLUMN "DGMARCU2"."AS3_CLIENT"."WORK_PHONE" IS 'ASSUMING ALL CLIENTS RESIDE WITHIN THE UNITED STATES';
 COMMENT ON COLUMN "DGMARCU2"."AS3_CLIENT"."HOME_PHONE" IS 'ASSUMING ALL CLIENTS RESIDE WITHIN THE UNITED STATES';

 CREATE OR REPLACE EDITIONABLE TRIGGER "DGMARCU2"."AS3_CLIENT_TRIG1"
  BEFORE INSERT ON AS3_CLIENT
  FOR EACH ROW
 DECLARE
 BEGIN
  IF( :NEW.CLIENT_ID IS NULL )
  THEN
   :NEW.CLIENT_ID := AS3_CLIENT_ID_SEQ.NEXTVAL;
  END IF;
 END;
 /
 ALTER TRIGGER "DGMARCU2"."AS3_CLIENT_TRIG1" ENABLE;




 CREATE TABLE "DGMARCU2"."AS3_CONTAINS"
 (
   "CONTAINED_WITHIN" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   "CONTAINER" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   CONSTRAINT "AS3_CONTAINS_PK" PRIMARY KEY ("CONTAINED_WITHIN","CONTAINER") ENABLE,
   CONSTRAINT "AS3_CONTAINS_FK1" FOREIGN KEY ("CONTAINED_WITHIN") REFERENCES "DGMARCU2"."AS3_WORK" ("WORK_NM") ON DELETE CASCADE ENABLE,
   CONSTRAINT "AS3_CONTAINS_FK2" FOREIGN KEY ("CONTAINER") REFERENCES "DGMARCU2"."AS3_WORK" ("WORK_NM") ON DELETE CASCADE ENABLE
 );




CREATE TABLE "DGMARCU2"."AS3_PURCHASES"
 (
   "WORK_NM" VARCHAR2(300 BYTE) NOT NULL ENABLE,
   "CLIENT_ID" NUMBER NOT NULL ENABLE,
   "ESTIMATED_TIME" FLOAT NOT NULL ENABLE,
   "SCHEDULED_DATE" DATE NOT NULL ENABLE,
   "ACTUAL_TIME" FLOAT,
   CONSTRAINT "AS3_PURCHASES_PK" PRIMARY KEY ("WORK_NM", "CLIENT_ID", "SCHEDULED_DATE") ENABLE,
   CONSTRAINT "AS3_PURCHASES_FK1" FOREIGN KEY ("WORK_NM") REFERENCES "DGMARCU2"."AS3_WORK" ("WORK_NM") ON DELETE CASCADE ENABLE,
   CONSTRAINT "AS3_PURCHASES_FK2" FOREIGN KEY ("CLIENT_ID") REFERENCES "DGMARCU2"."AS3_CLIENT" ("CLIENT_ID") ON DELETE CASCADE ENABLE
 );




CREATE TABLE "DGMARCU2"."AS3_PET_COMMENT"
 (
   "CLIENT_PK" NUMBER NOT NULL ENABLE,
   "PET_COMMENT" VARCHAR2(3000 BYTE) NOT NULL ENABLE,
   CONSTRAINT "AS3_PET_COMMENT_PK" PRIMARY KEY ("CLIENT_PK", "PET_COMMENT") ENABLE,
   CONSTRAINT "AS3_PET_COMMENT_FK1" FOREIGN KEY ("CLIENT_PK") REFERENCES "DGMARCU2"."AS3_CLIENT" ("CLIENT_ID") ON DELETE CASCADE ENABLE
 );





INSERT INTO AS3_CLIENT (FNAME, LNAME, HOUSE_SIZE, NUM_BATHS, STREET_ADDRESS, CITY, STATE, ZIP, WORK_PHONE, HOME_PHONE)
VALUES ('NICK', 'MASON', 3000, 4, '123 PIECES', 'SEATTLE', 'WA', '67599', '7655678493', '8766789090');

INSERT INTO AS3_CLIENT (FNAME, LNAME, HOUSE_SIZE, NUM_BATHS, STREET_ADDRESS, CITY, STATE, ZIP, WORK_PHONE, HOME_PHONE)
VALUES ('DAVE', 'GILMOUR', 5000, 5, '234 GREEN', 'GLENCOE', 'IL', '67784', '6454322345', '1234509836');

INSERT INTO AS3_CLIENT (FNAME, LNAME, HOUSE_SIZE, NUM_BATHS, STREET_ADDRESS, CITY, STATE, ZIP, WORK_PHONE, HOME_PHONE)
VALUES ('RICK', 'WRIGHT', 6000, 6, '768 BREATHE', 'CHICAGO', 'IL', '10980', '1230467834', '8761209387');

INSERT INTO AS3_CLIENT (FNAME, LNAME, HOUSE_SIZE, NUM_BATHS, STREET_ADDRESS, CITY, STATE, ZIP, WORK_PHONE, HOME_PHONE)
VALUES ('ROGER', 'WATERS', 10000, 8, '455 TIME', 'MADISON', 'WI', '12234', '6780901231', '6758902343');

INSERT INTO AS3_CLIENT (FNAME, LNAME, HOUSE_SIZE, NUM_BATHS, STREET_ADDRESS, CITY, STATE, ZIP, WORK_PHONE, HOME_PHONE)
VALUES ('SYD', 'BARRETT', 1000, 4, '897 ARNOLD LANE', 'ROCHESTER', 'MN', '09902', '6782336676', '9902378898');




INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('WINDOW WASHING', 8.99, 'N', 'WASHES WINDOWS');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('FLOOR WAX', 9.99, 'N', 'WAX THE FLOOR');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('CARPET STEAM CLEAN', 12.99, 'N', 'STEAM CLEAN THE CARPET');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('DUSTING', 7.99, 'N', 'DUST HOUSE');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('VACUUMING', 9.99, 'N', 'VACUUM WALLS');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('KITCHEN FLOOR WASH', 9.99, 'N', 'WASH KITCHEN FLOOR');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('FURNITURE POLISHING', 13.99, 'N', 'POLISH FURNATURE');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('SHEET WASHING', 7.99, 'N', 'WASH SHEETS');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('BATHROOM CLEANING', 12.99, 'N', 'CLEAN BATHROOMS');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('CLOSET ORGANIZING', 8.99, 'N', 'ORGANIZE CLOSET');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('GENERAL TIDYING', 8.99, 'N', 'TIDY UP THINGS NICELY');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('ONCE OVER LIGHTLY', 23.99, 'Y', 'INCLUDES DUSTING, VACUUMING, AND KITCHEN FLOOR WASH');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('MY MOTHER IS COMING', 30.99, 'Y', 'INCLUDES WINDOW WASHING, CARPET STEAM CLEAN, FURNATURE POLISHING, AND ALL SERVICES INCLUDED WITHIN THE ONCE OVER LIGHTLY PACKAGE');

INSERT INTO AS3_WORK (WORK_NM, COST_HOUR, IS_PACKAGE, DESCRIPTION)
VALUES ('HOME MAKEOVER', 45.99, 'Y', 'INCLUDES BATHROOM CLEANING, CLOSET ORGANIZING, PLUS ALL THE SERVICES INCLUDED WITHIN THE MY MOTHER IS COMING PACKAGE');




INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('DUSTING', 'ONCE OVER LIGHTLY');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('VACUUMING', 'ONCE OVER LIGHTLY');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('KITCHEN FLOOR WASH', 'ONCE OVER LIGHTLY');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('ONCE OVER LIGHTLY', 'MY MOTHER IS COMING');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('WINDOW WASHING', 'MY MOTHER IS COMING');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('CARPET STEAM CLEAN', 'MY MOTHER IS COMING');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('FURNITURE POLISHING', 'MY MOTHER IS COMING');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('MY MOTHER IS COMING', 'HOME MAKEOVER');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('BATHROOM CLEANING', 'HOME MAKEOVER');

INSERT INTO AS3_CONTAINS (CONTAINED_WITHIN, CONTAINER)
VALUES ('CLOSET ORGANIZING', 'HOME MAKEOVER');




INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('MY MOTHER IS COMING', 1, 4.0, TO_DATE('2018/03/09', 'YYYY/MM/DD'), 4.1);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('MY MOTHER IS COMING', 2, 4.0, TO_DATE('2018/04/09', 'YYYY/MM/DD'), 4.2);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('ONCE OVER LIGHTLY', 3, 2.0, TO_DATE('2018/03/11', 'YYYY/MM/DD'), 2.1);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('ONCE OVER LIGHTLY', 4, 2.0, TO_DATE('2018/03/09', 'YYYY/MM/DD'), 1.9);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('HOME MAKEOVER', 5, 6.0, TO_DATE('2018/05/12', 'YYYY/MM/DD'), 6.3);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('HOME MAKEOVER', 1, 6.0, TO_DATE('2018/02/22', 'YYYY/MM/DD'), 6.2);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('VACUUMING', 2, 1.5, TO_DATE('2018/09/09', 'YYYY/MM/DD'), 1.5);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('DUSTING', 3, 1.0, TO_DATE('2018/08/09', 'YYYY/MM/DD'), 1.0);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('CARPET STEAM CLEAN', 4, 2.0, TO_DATE('2018/01/25', 'YYYY/MM/DD'), 2.4);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('BATHROOM CLEANING', 5, 4.0, TO_DATE('2018/04/07', 'YYYY/MM/DD'), 2.2);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('KITCHEN FLOOR WASH', 1, 1.5, TO_DATE('2018/06/07', 'YYYY/MM/DD'), 1.4);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('CLOSET ORGANIZING', 2, 3.0, TO_DATE('2018/08/18', 'YYYY/MM/DD'), 3.1);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('SHEET WASHING', 3, 3.0, TO_DATE('2018/03/24', 'YYYY/MM/DD'), 3.5);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('GENERAL TIDYING', 4, 2.0, TO_DATE('2018/02/13', 'YYYY/MM/DD'), 1.8);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('FURNITURE POLISHING', 5, 2.5, TO_DATE('2018/04/04', 'YYYY/MM/DD'), 3.0);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('FURNITURE POLISHING', 2, 2.0, TO_DATE('2018/01/07', 'YYYY/MM/DD'), 2.0);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('MY MOTHER IS COMING', 3, 4.0, TO_DATE('2018/11/09', 'YYYY/MM/DD'), 4.1);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('ONCE OVER LIGHTLY', 1, 3.0, TO_DATE('2018/05/24', 'YYYY/MM/DD'), 2.9);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('DUSTING', 5, 1.5, TO_DATE('2018/12/12', 'YYYY/MM/DD'), 1.5);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('KITCHEN FLOOR WASH', 4, 2.0, TO_DATE('2018/04/04', 'YYYY/MM/DD'), 2.1);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('MY MOTHER IS COMING', 1, 2.0, TO_DATE('2018/04/04', 'YYYY/MM/DD'), 2.1);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('ONCE OVER LIGHTLY', 1, 3.0, TO_DATE('2018/06/02', 'YYYY/MM/DD'), 2.9);

INSERT INTO AS3_PURCHASES(WORK_NM, CLIENT_ID, ESTIMATED_TIME, SCHEDULED_DATE, ACTUAL_TIME)
VALUES ('MY MOTHER IS COMING', 2, 4.0, TO_DATE('2018/10/02', 'YYYY/MM/DD'), 4.9);





INSERT INTO AS3_PET_COMMENT(CLIENT_PK, PET_COMMENT)
VALUES (3, 'PLEASE DO NOT LET MY DOG, SEAMUS, OUTSIDE');

INSERT INTO AS3_PET_COMMENT(CLIENT_PK, PET_COMMENT)
VALUES (4, 'WATCH OUT FOR MY PET PIG, HE CAN BE A REAL CHARADE!');

INSERT INTO AS3_PET_COMMENT(CLIENT_PK, PET_COMMENT)
VALUES (1, 'NONE');

INSERT INTO AS3_PET_COMMENT(CLIENT_PK, PET_COMMENT)
VALUES (2, 'NONE');

INSERT INTO AS3_PET_COMMENT(CLIENT_PK, PET_COMMENT)
VALUES (5, 'NONE');



/*Count the number of houses which have the size of 2,000 square feet or more.*/
SELECT COUNT(HOUSE_SIZE)
FROM AS3_CLIENT
WHERE HOUSE_SIZE > 2000;

/*What jobs does package X contain, and how much does each job cost per hour?*/
SELECT COST_HOUR, WORK_NM
FROM AS3_WORK, AS3_CONTAINS
WHERE WORK_NM = CONTAINED_WITHIN AND CONTAINER = 'ONCE OVER LIGHTLY'

/*What is the amount of the discount customers will get when purchasing the package X
(from the previous question)?*/
SELECT X - Y
FROM
(SELECT AVG(COST_HOUR) * 3 AS X
FROM AS3_WORK, AS3_CONTAINS
WHERE WORK_NM = CONTAINED_WITHIN AND CONTAINER = 'ONCE OVER LIGHTLY'),
(SELECT COST_HOUR AS Y
FROM AS3_WORK
WHERE WORK_NM = 'ONCE OVER LIGHTLY')

/*In the last month, who has purchased package X?*/
SELECT AS3_PURCHASES.SCHEDULED_DATE, AS3_CLIENT.*
FROM AS3_CLIENT, AS3_PURCHASES
WHERE SCHEDULED_DATE BETWEEN TO_DATE('01/10/2018', 'DD/MM/YYYY') AND TO_DATE('31/10/2018', 'DD/MM/YYYY') AND AS3_PURCHASES.CLIENT_ID = AS3_CLIENT.CLIENT_ID
ORDER BY AS3_PURCHASES.SCHEDULED_DATE;

/*Create a report that lists a client's complete information.*/
SELECT SUM(ESTIMATED_TIME), AS3_CLIENT.CLIENT_ID, AS3_CLIENT.FNAME, AS3_CLIENT.LNAME, AS3_CLIENT.HOUSE_SIZE, AS3_CLIENT.NUM_BATHS, AS3_CLIENT.STREET_ADDRESS, AS3_CLIENT.CITY, AS3_CLIENT.STATE, AS3_CLIENT.ZIP, AS3_CLIENT.WORK_PHONE, AS3_CLIENT.HOME_PHONE
FROM AS3_PURCHASES, AS3_CLIENT
WHERE AS3_CLIENT.CLIENT_ID = AS3_PURCHASES.CLIENT_ID AND AS3_CLIENT.CLIENT_ID= 5
GROUP BY AS3_CLIENT.CLIENT_ID, AS3_CLIENT.FNAME, AS3_CLIENT.LNAME, AS3_CLIENT.HOUSE_SIZE, AS3_CLIENT.NUM_BATHS,
AS3_CLIENT.STREET_ADDRESS, AS3_CLIENT.CITY, AS3_CLIENT.STATE, AS3_CLIENT.ZIP, AS3_CLIENT.WORK_PHONE,
AS3_CLIENT.HOME_PHONE

/*Give the names and addresses of clients for whom we did work on date X.*/
SELECT AS3_PURCHASES.SCHEDULED_DATE, AS3_CLIENT.FNAME, AS3_CLIENT.LNAME, AS3_CLIENT.STREET_ADDRESS, AS3_CLIENT.CITY, AS3_CLIENT.STATE, AS3_CLIENT.ZIP
FROM AS3_PURCHASES, AS3_CLIENT
WHERE AS3_PURCHASES.SCHEDULED_DATE = TO_DATE('09/09/2018', 'DD/MM/YYYY') AND AS3_CLIENT.CLIENT_ID = AS3_PURCHASES.CLIENT_ID;

/*Assuming that the estimate for purchase order X is accurate, how much will the work cost
the client?*/
SELECT SUM(AS3_PURCHASES.ESTIMATED_TIME * AS3_WORK.COST_HOUR)
FROM AS3_CLIENT, AS3_PURCHASES, AS3_WORK
WHERE AS3_WORK.WORK_NM = AS3_PURCHASES.WORK_NM AND AS3_CLIENT.CLIENT_ID = AS3_PURCHASES.CLIENT_ID AND AS3_PURCHASES.WORK_NM = 'FURNITURE POLISHING' AND AS3_PURCHASES.CLIENT_ID = 5 AND AS3_PURCHASES.SCHEDULED_DATE = TO_DATE('04/04/2018', 'DD/MM/YYYY')
